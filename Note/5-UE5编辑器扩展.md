[UE5 编辑器扩展（进阶篇） - EditorExtend - Editor - UnrealEngine | Senior Brother = 打爆你滴脑阔 = 笔记 (xiaoliangcoder.github.io)](https://xiaoliangcoder.github.io/Source/UnrealEngine/EditorExtend/EditorExtendIntermediate/)



# Spawn a Custom Editor Tab（生成一个自定义编辑切页）

> 使用 FGlobalTabManager 来注册一个编辑切页
>
> 



# SLATE_BEGIN_ARGS

在 Unreal Engine 5 (UE5) 中，Slate 是用于构建用户界面（UI）的一个渲染和输入处理库。它允许开发者创建可定制的编辑器工具、游戏内UI以及其他交互式图形界面。

`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 是一组宏，它们被用来定义 Slate 构造函数的参数包。这些宏通常用于 Slate 的 widget 构造中，以便于传递构造一个 widget 所需要的各种参数。

### 示例用法

一个简单的使用 `SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 的例子是创建一个按钮 widget：

```cpp
class SMyButton : public SButton
{
public:

	SLATE_BEGIN_ARGS(SMyButton) {}
	SLATE_END_ARGS()

public:

	void Construct(const FArguments& InArgs)
	{
		SButton::Construct(
			SButton::FArguments()
			// 这里可以添加从 InArgs 中提取的具体参数
			.Content()
			[
				// 按钮的内容，例如文本或图像
			]
		);
	}

	// 其他成员函数和变量...
};
```

在这个例子中，`SMyButton` 类继承自 `SButton` 类，并且定义了构造函数参数。`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 宏定义了一个空的参数列表，你可以在这个列表中添加任何你希望传递给构造函数的参数类型。

当实际使用这个类来创建按钮时，你可以像这样传递参数：

```cpp
SNew(SMyButton)
	.Text(FText::FromString("Click Me"))
	// 可以继续添加其他参数
;
```

这里的 `SNew` 是 Slate 的工厂函数，它用于创建一个新的 Slate widget 实例，并传递构造参数。

`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 之间的部分可以被用来声明构造函数的默认参数值，以及任何必要的类型定义。这使得在创建 Slate widgets 时能够灵活地传递参数，同时也提供了默认行为。

在 Unreal Engine 的源码中，`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 实际上会生成一个类似于以下结构的代码：

```c++
1#define SLATE_BEGIN_ARGS(WidgetType) \
2    struct FArguments \
3    { \
4        // 默认参数定义，例如文本，默认为空字符串 \
5        FText _Text; \
6        TSharedRef<FSlateStyleSet> _Style; \
7        // 更多默认参数... \
8        FArguments() \
9        { \
10            // 初始化默认参数 \
11        } \
12    }; \
13    using MyArgs = FArguments;
14
15#define SLATE_END_ARGS() \
16    SLATE_DECLARE.Args(MyArgs)
17
18// 宏展开后可能会类似如下结构:
19struct SMyButton::FArguments
20{
21    FText _Text;
22    TSharedRef<FSlateStyleSet> _Style;
23    // 更多参数...
24
25    FArguments()
26        : _Text(FText::GetEmpty())
27        , _Style(FAppStyle::Get())
28    {
29        // 初始化更多默认参数
30    }
31};
32
33using SMyButton::MyArgs = FArguments;
```

这里的 `SLATE_DECLARE.Args` 可能是一个内部定义的宏或者模板，它会生成一个构造函数的参数列表。`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 宏之间的部分则用于声明构造函数的参数类型，并且初始化这些参数的默认值。

通过这种方式，`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 宏帮助我们管理构造函数参数，使得在创建 Slate widget 时能够更加方便地传递参数，并且保持良好的可读性和灵活性。



## FArguments

在 Unreal Engine 中，`FArguments` 是一种特殊的结构，用于在构造 UI 组件（通常是 Slate Widgets）时传递参数。Slate 是 Unreal Engine 的用户界面框架，它使用了一个基于声明式的构建系统，允许开发者通过构造函数参数来定制 UI 控件的行为和外观。

### `FArguments` 的作用

`FArguments` 结构体通常被用来定义 Slate Widget 构造函数的参数。当创建一个新的 Slate Widget 时，可以使用 `FArguments` 来指定该控件的各种属性，如文本、颜色、尺寸、行为响应等等。`FArguments` 提供了一种方便的方式来传递多个构造参数，并且这些参数通常有默认值，这样你可以只设置需要改变的部分，而省略其他默认值。

### 示例

下面是一个简单的例子，展示了如何定义一个带有 `FArguments` 的 Slate Widget 构造函数：

```cpp
// 定义一个自定义的按钮类，继承自Slate的SButton类
class SMyCustomButton : public SButton
{
public:

    // 使用SLATE_DECLARE_CONSTRUCTOR宏定义构造函数
    SLATE_BEGIN_ARGS(SMyCustomButton)
        // 定义构造函数参数，并为其设置默认值
        .Default__Text(FText::GetEmpty())
        .Default__ColorAndOpacity(FLinearColor::White)
    SLATE_END_ARGS()

    // 构造函数
    void Construct(const FArguments& InArgs)
    {
        // 使用传递进来的参数构建按钮
        SButton::Construct(
            SButton::FArguments()
            .Text(InArgs._Text) // 设置按钮文本
            .ButtonStyle(&InArgs._Style) // 设置按钮样式
            .OnClicked(InArgs._OnClicked) // 设置点击事件
            .ColorAndOpacity(InArgs._ColorAndOpacity) // 设置颜色
        );
    }

private:
    FLinearColor ColorAndOpacity;
    // 更多私有成员变量...
};
```

在这个例子中，`SMyCustomButton` 类定义了几个构造函数参数，包括按钮上的文本、颜色、样式以及点击事件处理函数。当你创建 `SMyCustomButton` 的实例时，你可以选择性地设置这些参数中的任何一个，未设置的参数将会使用默认值。

### `FArguments` 的内部实现

实际上，`FArguments` 并不是单个具体的类或结构体，而是一系列宏和模板的组合，用于生成构造函数参数。当你在 `SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 之间定义参数时，这些宏会在编译时生成适当的代码来创建参数结构体，并为这些参数设置默认值。

例如，在上面的例子中，`SLATE_BEGIN_ARGS` 和 `SLATE_END_ARGS` 会生成类似如下的代码：

```cpp
struct SMyCustomButton::FArguments
{
    FText _Text;
    FSlateStyleSet* _Style;
    FLinearColor _ColorAndOpacity;
    FReply (*_OnClicked)(const FGeometry&, const FPointerEvent&);

    FArguments()
        : _Text(FText::GetEmpty())
        , _Style(FAppStyle::Get().Get())
        , _ColorAndOpacity(FLinearColor::White)
        , _OnClicked(nullptr)
    {}
};
```

这种机制使得 `SMyCustomButton` 能够通过 `FArguments` 接收并处理构造参数，同时也允许使用者在创建控件时灵活地传递参数。